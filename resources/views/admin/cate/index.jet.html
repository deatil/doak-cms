{{extends "/admin/common/base_content"}}

{{block title()}}分类管理 - Doak CMS{{end}}

{{block body()}}

<style>
.nodata {
    text-align: center;
    padding: 15px;
}
.table tr {
    vertical-align: middle;
}
</style>
<div class="container-fluid pt-4 px-4">
    <div class="row g-4">
        <div class="col-sm-12 col-xl-12">
        
            <div class="bg-light rounded h-100 p-4">
                <h6 class="mb-4">
                    分类管理
                    <a href="/sys/cate/add" class="ms-1" title="添加分类">
                        <i class="fa fa-plus"></i>
                    </a>
                </h6>
                
                <div class="table-responsive">
                    <table class="table table-bordered table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">名称</th>
                                <th scope="col">标识</th>
                                <th scope="col">添加时间</th>
                                <th scope="col">状态</th>
                                <th scope="col">操作</th>
                            </tr>
                        </thead>
                        
                        <tbody>
                            {{ range index, value := list }} 
                                <tr>
                                    <th scope="row">{{ value.Id }}</th>
                                    <td>{{ value.Name }}</td>
                                    <td>{{ value.Slug }}</td>
                                    <td width="165">
                                        {{ createTime(value.AddTime, "Asia/Shanghai").DateTimeString() }}
                                    </td>
                                    <td width="45">
                                        {{if value.Status == "1" }}
                                            <span class="badge bg-success">启用</span>
                                        {{else}}
                                            <span class="badge bg-danger">禁用</span>
                                        {{end}}
                                    </td>
                                    <td width="150">
                                        <a class="btn btn-primary btn-sm" 
                                            href="/sys/cate/{{ value.Id }}/edit" >
                                            编辑
                                        </a>
                                        
                                        <a href="javascript:;" 
                                            class="btn btn-danger btn-sm js-delete-btn"
                                            data-url="/sys/cate/{{ value.Id }}/delete"
                                        >
                                            删除
                                        </a>
                                    </td>
                                </tr>
                            {{ else }} 
                                <tr>
                                    <td colspan="6">
                                        <div class="nodata">
                                            无数据
                                        </div>
                                    </td>
                                </tr>
                            {{ end }}
                            
                        </tbody>
                    </table>
                </div>
                
                <nav aria-label="Page navigation example">
                    {{ pageHtml|raw }}
                </nav>

            </div>

        </div>
    </div>
</div>

{{end}}

{{block script_after()}}
<script type="3029259e35d7bc1c98cd40a8-text/javascript">
(function($) {
    "use strict";
    
    $(".sidebar-cate-index").addClass("active");
    
    // 删除
    $('.js-delete-btn').click(function() {
        var url = $(this).data('url');
        
        layer.confirm('您确定要删除该分类吗？', {
            offset: 'c',
            btn: ['确定', '取消']
        }, function(index){
            $.post(url, {}, function(data) {
                if (data.code == 0) {
                    layer.msg(data.message, {
                        offset: 'c',
                        icon: 1
                    });

                    setTimeout(function() {
                        location.reload();
                    }, 2000);
                } else {
                    layer.msg(data.message, {
                        offset: 'c',
                        icon: 2
                    });
                }
            });
        });
    });

})(jQuery);
</script>
{{end}}